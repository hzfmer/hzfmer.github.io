---
layout: post
title: 字符编码笔记： ASCII，Unicode和UTF-8
date: 2018-01-13
tag: 计算机入门 编码
---

本文从[阮一峰的一篇博文](http://www.ruanyifeng.com/blog/2007/10/ascii_unicode_and_utf-8.html)修改而来，兼练习Markdown语法格式。

字符编码是计算机技术的基础。

### 1 ASCII码

计算机内部以二进制格式存储信息。八个二进制位可以组合出256种状态，称为一个字节（byte）。

二十世纪60年代，美国制定了一套字符编码，对英文字符，数字及一些特殊符号与二进制位之间的关系作了统一规定，即今天的 ASCII 码。ASCII 码的第一位统一定为0，之后的7位规定了128个字符的编码。



### 2 非ASCII编码

一些国家利用闲置的最高位编入新的符号，从而可以使用多达256个符号。很多亚洲国家必须使用多个字节来表达一个符号，如简体中文的常见编码方式 GB2312，使用两个字符表示一个汉字，理论上最多可以表示 $256\times256 = 65536$ 个符号。



GB类的中文编码与后文的 Unicode 和 UTF-8 毫无关系。



### 3 Unicode

Unicode 是一个很大的集合，包含所有字符多编码，可以容纳100多万个字符。

具体的符号对应表可以查询[unicode.org](http://www.unicode.org)，或者专门的[汉字对应表](http://http://www.chi2ko.com/tool/CJK.htm)。



### 4 Unicode 的问题

需要注意的是，Unicode 只是一个符号集，规定了符号的二进制代码，却没有规定这个二进制代码应该如何存储。

比如，汉字 `严` 的 Unicode 是十六进制数 `4E25`，转换成二进制有15位 （`100111000100101`），也就是说这个字符的表示至少需要2个字节。其他字符则可能需要更多字节。

这就带来两个问题。第一，计算机怎样区分 Unicode 和 ASCII ？ 三个字节可能代表 Unicode 中的一个字符，也可能代表 ASCII 中的三个字符。第二个问题是如果 Unicode 强行规定每个符号用多个字节表示，那么对英文字符会产生存储的极大浪费。

它们的结果是：1）出现了 Unicode 的多种二进制格式的存储方式。 2）Unicode 很长时间得不到推广，直至互联网出现。



### 5 UTF-8

互联网的普及推动了统一编码方式的出现。UFT-8 是在互联网上使用最广的一种 Unicode 的实现方式。其他实现方式包括 UTF-16 （字符用两个或四个字节表示）和 UTF-32 （字符用四个字节表示），在互联网上基本不用。



UTF-8 最大的特点就是它是一种变长的编码方式，使用1～4个字节表示一个字符，根据不同字符变化字节长度。UTF-8 的编码规则很简单，只有两条。

1）对于单字节的符号，字节的第一位设为0，后面7位为这个符号的 Unicode 码。 因此对于英语字母， UTF-8 编码和 ASCII 码是一样的。

2） 对于 `n` 字节的符号 （`n > 1 `）， 第一个字节的前 `n` 位都设为1，第 `n + 1` 位设为 `0` ，其他字节的前两位一律设为 `10`。 剩下的二进制位，即为这个字符的 Unicode 码。



下表总结了编码规则，字母 `x` 表示可用编码的位置.

| Unicode 符号范围          | UTF-8 编码方式                          |
| :-------------------- | :---------------------------------- |
| （十六进制）                | （二进制）                               |
| 0000 0000 - 0000 007F | 0xxxxxxx                            |
| 0000 0080 - 0000 07FF | 110xxxxx 10xxxxxx                   |
| 0000 0800 - 0000 FFFF | 1110xxxx 10xxxxxx 10xxxxxx          |
| 0001 0000 - 0010 FFFF | 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx |



依上，解读 UTF-8 编码非常简单，以 `严` 为例。

`严` 的 Unicode 是 `4E25` （`100111000100101`），根据上表，处在第三行的范围内，因此需要三个字节。格式即为`1110xxxx 10xxxxxx 10xxxxxx`，然后从`严` 的最后一个二进制位开始，依次从后向前填入格式中的 `x` ，多出的位补 `0`。 这样就得到了 `严` 的UTF-8 编码为 `11100100 10111000 10100101`，转换成十六进制就是 `E4B8A5`。



### 6 Unicode 与 UTF-8 之间的转换

如 Windows 平台的记事本 `notepad.exe`，有四种编码保存格式。

1.  `ANSI` 默认编码格式。对于英文是 `ASCII` ， 对于中文是 `GB3212` （繁体中文则为 `Big5`）。
2. `Unicode` 这里的`notepad.exe` 使用 UCS-2 编码方式，即直接用两个字节存入字符的 Unicode 码，这个选项采用 little endian 格式。
3. `Unicode big endian` 顾名思义。
4. UTF-8



### 7 Little endian 和 Big endian

以汉字 `严` 为例，其 Unicode 为 `4E25`，需要用两个字节存储。按照 Big endian 方式，为 `4E` `25`； 按照 Little endian 方式，为`25` `4E` 。

这两个名称的来源是英国作家斯威夫特的《格列佛游记》。该书中小人国爆发内战的起因是一场争论：吃鸡蛋时究竟从大头（Big-endian）还是小头（Little -endian）敲开。为了这件事情，前后爆发了六场战争，一个皇帝送了命，另一个皇帝丢了王位。

被借用在计算机术语中，Big endian 就是第一个字节在前的方式；Little endian 则是第二个字节在前。Unicode 规定文件开头要加入一个表示编码顺序的字符 BOM （byte-order mark），叫做 “零宽度非换行空格“ （zero width no-break space），用 `FEFF` 表示。当一个文件的头两个字节是 `FEFF` ， 表示该文件采用 Big endian 方式； 如果头两个字节是 `FFFE` 则表示采用 Little endian 方式。



### 补充

国际标准化组织通过了一套 ISO-8859-1 的编码，规定了单字节256个符号的编码，是目前的8位编码国际标准。

UTF-8 也有BOM，是 ”EF BB BF“，三个字节。因为 UTF-8 没有顺序问题，文件头实际不起作用，但在一些实用 ISO-8859-1 的编程语言中，必须去掉，保存为 “UTF-8-无BOM“ 的格式。



### 延伸资料

<http://my.oschina.net/goldenshaw/blog?catalog=536953>

<http://www.pconline.com.cn/pcedu/empolder/gj/other/0505/616631.html>



